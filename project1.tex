\documentclass[legalpaper]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
    \usepackage{xltxtra,xunicode}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Mapping=tex-text,Scale=MatchLowercase}
  \newcommand{\euro}{â‚¬}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{{#1}}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{{#1}}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{{#1}}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{{#1}}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{{#1}}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{{#1}}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{{#1}}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{{#1}}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{{#1}}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{{#1}}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{{#1}}}
\newcommand{\RegionMarkerTok}[1]{{#1}}
\newcommand{\ErrorTok}[1]{\textbf{{#1}}}
\newcommand{\NormalTok}[1]{{#1}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\ifxetex
  \usepackage[setpagesize=false, % page size defined by xetex
              unicode=false, % unicode breaks when used with xetex
              xetex]{hyperref}
\else
  \usepackage[unicode=true]{hyperref}
\fi
\hypersetup{breaklinks=true,
            bookmarks=true,
            pdfauthor={Frank Jung},
            pdftitle={A study of Central Limit Theorem with Exponential Distribution},
            colorlinks=true,
            citecolor=blue,
            urlcolor=blue,
            linkcolor=magenta,
            pdfborder={0 0 0}}
\urlstyle{same}  % don't use monospace font for urls
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\setcounter{secnumdepth}{5}

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\newcommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}
  \title{A study of Central Limit Theorem with Exponential Distribution}
  \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
  \author{Frank Jung}
  \preauthor{\centering\large\emph}
  \postauthor{\par}
  \date{}
  \predate{}\postdate{}



\begin{document}

\maketitle


{
\hypersetup{linkcolor=black}
\setcounter{tocdepth}{2}
\tableofcontents
}
\section{Synopsis}\label{synopsis}

This short project will study the
\href{https://en.wikipedia.org/wiki/Central_limit_theorem}{Central Limit
Theorem} using simulated calls of the
\href{https://en.wikipedia.org/wiki/Exponential_distribution}{exponential
distribution}. It will:

\begin{itemize}
\itemsep1pt\parskip0pt\parsep0pt
\item
  show that the \hyperref[sample-mean-versus-theoretical-mean]{sample
  mean converges to the theoretical mean} of the distribution
\item
  compare the \hyperref[sample-mean-versus-theoretical-mean]{sample
  variance to the theoretical variance} of the distribution
\item
  show that the
  \hyperref[distribution-is-approximately-normal]{distribution is
  approximately normal}
\end{itemize}

\section{Simulation}\label{simulation}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{set.seed}\NormalTok{(}\DecValTok{040}\NormalTok{)}
\NormalTok{lambda <-}\StringTok{ }\FloatTok{0.2}
\NormalTok{observ <-}\StringTok{ }\DecValTok{40}
\NormalTok{samples <-}\StringTok{ }\DecValTok{1000}
\CommentTok{# simulated data 1000 sample rows by 40 observation columns}
\NormalTok{simdata <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\KeywordTok{sapply}\NormalTok{(}\DecValTok{1}\NormalTok{:samples, function(x) }\KeywordTok{rexp}\NormalTok{(observ, lambda)), samples, observ)}
\CommentTok{# means and variances of each sample}
\NormalTok{simmeans <-}\StringTok{ }\KeywordTok{apply}\NormalTok{(simdata, }\DecValTok{1}\NormalTok{, function (x) }\KeywordTok{mean}\NormalTok{(x[]))}
\NormalTok{simvars <-}\StringTok{ }\KeywordTok{apply}\NormalTok{(simdata, }\DecValTok{1}\NormalTok{, function (x) }\KeywordTok{var}\NormalTok{(x[]))}
\NormalTok{mu =}\StringTok{ }\DecValTok{1}\NormalTok{/lambda}
\NormalTok{se =}\StringTok{ }\KeywordTok{sqrt}\NormalTok{(}\DecValTok{1}\NormalTok{/lambda^}\DecValTok{2}\NormalTok{)/}\KeywordTok{sqrt}\NormalTok{(observ)}
\NormalTok{simnormals <-}\StringTok{ }\KeywordTok{apply}\NormalTok{(simdata, }\DecValTok{1}\NormalTok{, function (x) (}\KeywordTok{mean}\NormalTok{(x[]) -}\StringTok{ }\NormalTok{mu)/se)}
\CommentTok{# put into data frame use with plots}
\NormalTok{simdf <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{means =} \NormalTok{simmeans, }\DataTypeTok{vars =} \NormalTok{simvars, }\DataTypeTok{normals =} \NormalTok{simnormals)}
\end{Highlighting}
\end{Shaded}

We will perform \texttt{1000} simulatations of \texttt{40} observations
from the exponential distribution with \(\lambda\) of \texttt{0.2}. For
each of the simulations we will calculate the samples means, variances.
Finally, we will normalise the results for
\hyperref[distribution-is-approximately-normal]{later comparision} to
the standard normal.

\hyperdef{}{sample-mean-versus-theoretical-mean}{\section{Sample Mean
versus Theoretical Mean}\label{sample-mean-versus-theoretical-mean}}

Using \texttt{40} observations of the exponential distribution we will
sample it \texttt{1000} times, taking the mean for each sample. The mean
of these samples should approach the theoretical mean, (\(1/\lambda\)).

\begin{center}\includegraphics{figure/samplemean-1} \end{center}

\begin{itemize}
\itemsep1pt\parskip0pt\parsep0pt
\item
  The exponential distribution has a theoretical mean of \(1/\lambda\) =
  \texttt{5}.
\item
  The sample mean after \texttt{1000} draws is \texttt{4.99}.
\end{itemize}

\section{Sample Variance versus Theoretical
Variance}\label{sample-variance-versus-theoretical-variance}

As before, take \texttt{40} observations from the exponential
distribution, but this time measure the sample variance. Sample these
variances \texttt{1000} times and compare to the theoretical variance,
(\(1/\lambda^2\)).

\begin{center}\includegraphics{figure/samplevar-1} \end{center}

\begin{itemize}
\itemsep1pt\parskip0pt\parsep0pt
\item
  The exponential distribution has a theoretical variance of
  \(1/\lambda^2\) = \texttt{25}.
\item
  The sample variance after \texttt{1000} draws is \texttt{24.92}.
\end{itemize}

\hyperdef{}{distribution-is-approximately-normal}{\section{Distribution
is Approximately Normal}\label{distribution-is-approximately-normal}}

If we consider the normalised version,
\(\frac {\bar X_n - \mu} {\sigma / n}\), of our sample averages, then
the \href{https://en.wikipedia.org/wiki/Central_limit_theorem}{Central
Limit Theorem} states that this distribution of averages tends to that
of a standard normal as the sample size increases. Plotting the
histogram we should see a normal like distribution:

\begin{center}\includegraphics{figure/samplenormals-1} \end{center}

To help evaluate how close this is to our own simulation, we have
overlayed the normalised sample averages with the standard normal
distribution, \(N(0,1)\).

We can test this analyticallt using the
\href{https://stat.ethz.ch/R-manual/R-devel/library/stats/html/qqnorm.html}{Quantile-Quantile
Plots}. As you can see the sample quantiles (black circles) closely
match the standard normal (red line).

\begin{center}\includegraphics{figure/qqnorm-1} \end{center}

\end{document}
